# PostgreSQL Tuple

PostgreSQL tuple format specification.

## Preface

This document is an attempt to reverse-engineer tuple format specification as generated by PostgreSQL,
since no official documentation could be located while writing this library.

As of today, there is still an open question on StackOverflow: [PostgreSQL tuple format](http://stackoverflow.com/questions/39520517/postgresql-tuple-format)

## Content

* [Definition](#definition)
* [Tuple Object](#tuple-object)
* [Tuple Arrays](#tuple-array)

## Definition

In this document, by `tuple` we refer to string presentation for custom types, as supported by PostgreSQL,
i.e. a tuple is a result of serializing a custom data structure into a text string. 

When a `tuple` contains fields of another custom type, such structure is referred to as a `composite tuple`. 

A composite tuple can be of any complexity, including:

* Tuple arrays of any number of dimensions
* Composite tuple arrays of any number of dimensions

## Tuple Object

1. A single tuple always starts with `(` and ends with `)`
2. Values inside a tuple are comma-separated: `(val1,val2,...)`
3. A tuple can be empty: `()`
4. Spaces inside a tuple are never ignored. For example, `( )` is not an empty tuple, but a tuple with one value - space symbol.
5. String values are presented directly (as open values) when they have no spaces in them.
6. String values are presented inside double quotes when they have spaces in them.
7. Special symbols are encoded according to which symbol it is:
  1. Every double-quote `"` is doubled, to be `""`
  2. Every back-slash `\` is quadrupled, to be `\\\\`
8. Boolean values are presented as a single symbol: `t` for true and `f` for false
9. All Date/Time type of values are presented as strings.

## Tuple Arrays

1. A tuple that represents an array always starts with `{` and ends with `}`
2. Tuple values inside arrays are always wrapped in double-quotes: `{"(val1,val2)","(val1,val2)"}`

**Parts that I'm not sure about yet:**

3. Wrapping double-quotes for tuple values on nested levels are prefixed with back-slash?
